<div class="form help">
  <%const helps = [
    {title: "About", kind: "about"},
    {title: "Instructions", kind: "instr"},
    {title: "Syscalls", kind: "syscalls"},
    {title: "Directives", kind: "directives"},
    {title: "Registers", kind: "registers"},
    {title: "ASCII", kind: "ascii"}
  ];
  let activeSection = getActiveHelpTab() || 0;
  let help = helps[activeSection];
  if (!help) {
    sessionStorage.removeItem("help-tab-index");
    hideFormOnClick();
  }%>
  <div class="title-container">
    <%helps.map(h => h.title).forEach((title, i) => {%>
      <span
        class="section-title <%=i===activeSection ? "active" : ""%>"
        onclick="sectionTitleOnClick(<%=i%>)"
      ><%=title%></span>
      <span><%=i !== helps.length-1 ? "/" : ""%></span>
    <%});%>
  </div>
  <div class="content <%=help.kind%>">
    <%if (help.kind==="about") {%>
      <p>MIPSWEB is a web-based IDE, assembler, and virtual machine for MIPS-32. <span class="WIP">THIS IS A WORK IN PROGRESS</span>.<br/>
       The project is developed by <a class="name">Giuseppe Gadola</a>, <a class="name">Mattia Mendicino</a> and <a class="name" href="https://tarini.di.unimi.it/">Marco Tarini</a> from <a class="name" href="https://www.unimi.it/en">University of Milan</a>.</p>
    <%} else if (help.kind==="instr") {%>
      <p style="margin:0;opacity:0.7;font-style:italic;">Pseudoinstructions are marked in <span style="color:var(--rgb-blue)">blue</span></p>
      <div class="table">
        <div class="cols-names">
          <div class="col name">Name</div>
          <div class="col longname">Long name</div>
          <div class="col params">Params</div>
          <div class="col desc">Description</div>
        </div>
        <div class="rows">
          <%getAllInstructionsHelp().forEach((instrHelp, i) => {%>
            <div class="row <%=i%2==0 ? "even" : ""%> <%=instrHelp.meta%>">
              <div class="col name">
                <%=instrHelp.symbol%>
              </div>
              <div class="col longname">
                <%-instrHelp.longName%>
              </div>
              <div class="col params">
                <%instrHelp.params.forEach(param => {%>
                  <div><%=instrHelp.symbol%> <%=param%></div>
                <%});%>
              </div>
              <div class="col desc">
                <p><%-instrHelp.description%></p>
              </div>
            </div>
          <%});%>
        </div>
      </div>
    <%} else if (help.kind==="directives") {%>
      <div class="table syscalls">
        <div class="cols-names">
          <div class="col symbol">Directive</div>
          <div class="col example">Example</div>
          <div class="col desc">Description</div>
        </div>
        <div class="rows">
          <%getDirectivesHelp().forEach((dirHelp, i) => {%>
            <div class="row <%=i%2==0 ? "even" : ""%>">
              <div class="col symbol"><%=dirHelp.symbol%></div>
              <div class="col example"><p><%-dirHelp.example.replace('\n', '<br/>')%></p></div>
              <div class="col desc"><p><%=dirHelp.description%></p></div>
            </div>
          <%});%>
        </div>
      </div>
    <%} else if (help.kind==="syscalls") {%>
      <div class="table syscalls">
        <div class="cols-names">
          <div class="col code">Code</div>
          <div class="col name">Name</div>
          <div class="col desc">Description</div>
        </div>
        <div class="rows">
          <%getSyscallHelp().forEach((syscallHelp, i) => {%>
            <div class="row <%=i%2==0 ? "even" : ""%>">
              <div class="col code"><%=syscallHelp.code%></div>
              <div class="col name"><%=syscallHelp.name%></div>
              <div class="col desc"><p><%-syscallHelp.description%></p></div>
            </div>
          <%});%>
        </div>
      </div>
    <%} else if (help.kind==="registers") {%>
      <p>Conventional use / <span class="invariant">HW features</span></p>
      <div class="table">
        <div class="cols-names">
          <div class="col num">Num</div>
          <div class="col name">Name</div>
          <div class="col longName">Full name</div>
          <div class="col desc">Description</div>
        </div>
        <div class="rows">
          <%getRegistersHelp().forEach((regHelp, i) => {%>
            <div class="row <%=i%2==0 ? "even" : ""%>">
              <div class="regs">
                <%regHelp.regs.forEach(({num, name}) => {%>
                  <div class="reg-row">
                    <div class="col num"><%=num%></div>
                    <div class="col name"><%=name%></div>
                  </div>
                <%});%>
              </div>
              <div class="col longName"><%-regHelp.longName%></div>
              <div class="col desc"><p><%-regHelp.description%></p></div>
            </div>
          <%});%>
        </div>
      </div>
    <%} else if (help.kind==="ascii") {%>
      <%const descriptions = getAsciiTableHelp();
      for (const col of [1,2,3,4]) {%>
        <div class="table">
          <div class="cols-names">
            <div class="col dec">Dec</div>
            <div class="col char">Char</div>
            <div class="col desc">Desc</div>
          </div>
          <div class="rows">
            <% for (i = 32*(col-1); i < 32*col; i++) {%>
              <div class="row <%=i%2==0 ? "even" : ""%>">
                <div class="col dec"><%=i%></div>
                <div class="col char"><%=asciiTable[i]%></div>
                <div class="col desc"><div><%=descriptions[i] ?? ""%></div></div>
              </div>
            <%}%>
          </div>
        </div>
      <%}}%>
  </div>
  <div class="buttons">
      <button class="button default" onclick="hideFormOnClick();">
          <div class="icon gray-4"><%-Icons.render('x')%></div>
          <div class="label">Close</div>
      </button>
  </div>
</div>
